2003-08-17  Marcus Brinkmann  <marcus@gnu.org>

	* vga-dynafont.c: Include <stddef.h>.
	(struct mapped_character): Change type of LOCP to
	hurd_ihash_locp_t.
	(struct dynafont): Change type of CHARMAP to struct hurd_ihash.
	(dynafont_new): Use hurd_ihash_init instead of ihash_create.
	Remove variable ERR.  Call hurd_ihash_add instead of ihash_add.
	(dynafont_free): Call hurd_ihash_destroy, no ihash_free.
	(dynafont_lookup_internal): Use hurd_ihash_find, not ihash_find.
	(dynafont_lookup_internal): Call hurd_ihash_locp_remove instead
	ihash_locp_remove, and hurd_ihash_add instead ihash_add.
	(dynafont_change_font): Likewise.  Clean out LOCP if character is
	unmapped.	

2004-02-02  Marco Gerards  <metgerards@student.han.nl>

	* pc-kbd.c (KDSETLEDS): New macro.
	(update_leds): Add support for setting the keyboard LED state on
	GNUMach 1.x (> 1.3).
	(input_loop): Use size_t for `nr' instead of int to silence a gcc
	warning.

2003-08-11  Marco Gerards  <metgerards@student.han.nl>

	* console.c (cons_vcons_set_dimension): New function.
	* display.h (display_ops): New interface set_dimension.
	* ncursesw.c (ncursesw_set_dimension): New function.
	(ncursesw_displ): Add ncursesw_set_dimension.
	(ncurses_lock): Make variable static.
	(current_width): New variable.
	(current_height): Likewise.
	(cursor_state): Likewise.
	(cursor_hidden): Likewise.
	(driver_ncursesw_ops): Added ncursesw_set_dimension.
	* vga.c (current_width): New variable.
	(current_height): Likewise.
	(vga_display_set_cursor_status): If the cursor is outside the
	screen, don't change the visibility.
	(vga_display_set_cursor_pos): Don't set the cursor outside the
	physical screen.  Update cursor_hidden and hide/unhide
	to match cursor_hidden.  Function moved to above
	vga_display_set_cursor_status.
	(vga_display_scroll): Report an error when scrolling is not
	possible.
	(vga_display_clear): Recalculate cols, rows and length.
	(vga_display_write): Make it wrap around the edge.
	(vga_set_dimension): New function.
	(vga_disp_ops): Added vga_set_dimension.

	* ncursesw.c (conspad): New variable.
	(padx): Likewise.
	(pady): Likewise.
	(autoscroll): Likewise.
	(refresh_screen): new function.
	(input_loop): Use conspad instead of (the default) stdscr.
	Call console_exit instead of exiting here.  Add keybindings
	'j, 'k', 'l' and 'i' to scroll the console, add keybinding 'a'
	to switch autoscroll.
	(mvwputsn): Use conspad instead of (the default) stdscr.
	(ncursesw_scroll): Likewise.
	(ncursesw_write): Likewise.
	(ncursesw_driver_start): Likewise. Initialize conspad.
	(ncursesw_update): Call refresh_screen to refresh the console.
	(ncursesw_set_cursor_pos): Use conspad instead of (the default)
	stdscr.  Make the console autoscroll.

	* ncursesw.c (ncursesw_driver_start): Remove endwin call at
	the end of the function.

	* ncursesw.c (ncursesw_set_cursor_status): If the status can
	not be set, use another status that can sanely be used instead
	of the unavailable status.

2003-07-14  Marco Gerards  <metgerards@student.han.nl>

	* vga.c: New global variable vga_display_max_glyphs.
	(parse_startup_args): New macro PARSE_FONT_OPT_NOARGS.
	(parse_startup_args): Parse "--max-colors" and "--max-glyphs".
	(vga_display_init): Set disp->df_size to match the color setting.

2003-02-24  Marco Gerards <metgerards@student.han.nl>

	* pc-kbd.c (sc_set1_to_set2): Map the set2 scancodes for F11 and
	F12 properly on the set1 scancodes for F11 and F12.

2002-11-25  Marcus Brinkmann  <marcus@gnu.org>

	* pc-kbd.c (IS_FUNC_KEY): Fix last change.

2002-11-21  Marco Gerards  <metgerards@student.han.nl>

	* pc-kbd.c (IS_FUNC_KEY): New macro.
	(input_loop): Replaced code for set1 for console switching by set2
	code.  Also accept F11 and F12.

2002-11-18  Marcus Brinkmann  <marcus@gnu.org>

	* console.c (main): Pass ERR to error invocation.
	* generic-speaker.c (generic_spaker_beep): Use currently active
	beep's next pointer, instead index 0.
	* pc-kbd.c: New global variables led_state and gnumach_v1_compat.
	(enum scancode): Change to set 2 encoding.
	(enum scancode_x1): Likewise.
	(enum scancode_x2): New type.
	(sc_to_kc): Change to set 2 encoding.
	(sc_x1_to_kc): Likewise.
	(sc_set1_to_set2): New variable.
	(sc_set1_to_set2_x1): Likewise.
	(gnumach_v1_input_next): New function.
	(update_leds): Likewise.
	(input_next): Likewise.
	(input_loop): Use input_next or gnumach_v1_input_next to read next
	key code.
	(pc_kbd_start): Add support for current GNU Mach @>=kbd interface.
	Call update_leds and toggle led_state.
	(pc_kbd_fini): Add support for current GNU Mach.
	(pc_kbd_set_scroll_lock_status): Toggle led_state and call
	update_leds.
	* vga-support.c (vga_init): Add support for current GNU Mach's I/O
	permission bitmap handling and its mem device.

2002-09-30  Marcus Brinkmann  <marcus@gnu.org>

	* vga-support.c (vga_get_font_width): New function.
	* vga-support.h: Add prototype for vga_get_font_width.
	* vga-dynafont.c (create_system_font): Call vga_get_font_width to
	determine real font width.

2002-09-22  Marcus Brinkmann  <marcus@gnu.org>

	* pc-kbd.c (sc_to_kc): Implement Meta-Backspace combinations.

2002-09-19  Marcus Brinkmann  <marcus@gnu.org>

	* vga-support.c (vga_read_write_font_buffer): New function.  It
	turns out that reading and writing needs the same register
	settings.
	(vga_write_font_buffer): Implement in terms of
	vga_read_write_font_buffer.
	(vga_read_font_buffer): Likewise.

2002-09-18  Marcus Brinkmann  <marcus@gnu.org>

	* ncursesw.c: Add an entry for the clear function.

	* pc-kbd.c (sv_to_kc): Add entries for unused scan codes 0x55 and
	0x56.

2002-09-17  Marcus Brinkmann  <marcus@gnu.org>

	* pc-kbd.c (input_loop): Move code that toggles NumLock after code
	that handles direct entry of character codes with RightAlt.

2002-09-17  Marcus Brinkmann  <marcus@gnu.org>

	* Makefile, bdf.c, bdf.h, bell.h, console.c, display.h, driver.c,
	driver.h, generic-speaker.c, input.h, pc-kbd.c, timer.c, timer.h,
	unicode.h, vga.c, vga-dynacolor.c, vga-dynacolor.h, vga-dynafont.c,
	vga-dynafont.h, vga-hw.h, vga-support.c, vga-support.h: New file.
